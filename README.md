# MCBE News - Minecraft 基岩版更新监控插件

自动监控 Minecraft 基岩版（MCBE）的官方更新文章，并使用 AI 总结后推送到指定群聊。

## ✨ 功能特性

- 🔄 **自动定时监控**：支持使用 Cron 表达式自定义检查频率
- 🧪 **多版本支持**：可分别监控 Beta 测试版和正式版更新
- 🤖 **AI 智能总结**：使用 LLM 自动总结文章要点，省去阅读长文的时间
- 📷 **富媒体展示**：自动提取并显示文章中的图片
- 📋 **快速预览列表**：一次查看多篇文章的简短预览，快速浏览
- 📱 **多群推送**：支持同时向多个群聊推送更新通知
- 💾 **去重机制**：自动记录已推送的文章，避免重复通知
- 🎯 **首次运行优化**：首次启动只推送最新文章，避免刷屏

## 📦 安装

1. 将本插件下载到 AstrBot 的 `data/plugins/` 目录下
2. 在 AstrBot WebUI 的插件管理页面启用插件
3. 插件会自动安装依赖

## ⚙️ 配置说明

在 WebUI 的插件配置页面进行设置：

| 配置项 | 说明 | 示例 |
|--------|------|------|
| **LLM 模型提供商** | 用于总结文章的 AI 模型 | 选择已配置的提供商 |
| **通知群聊 ID 列表** | 接收更新通知的群聊 ID，多个用英文逗号分隔 | `123456,789012` |
| **开启 Beta 版本监控** | 是否监控 Beta 测试版更新 | ✅ 是 / ❌ 否 |
| **开启正式版监控** | 是否监控正式版更新 | ✅ 是 / ❌ 否 |
| **定时监控 Cron 表达式** | 检查更新的时间计划 | `0 */2 * * *`（每2小时） |

### Cron 表达式示例

- `0 */2 * * *` - 每 2 小时检查一次
- `0 9,15,21 * * *` - 每天 9:00、15:00、21:00 检查
- `0 * * * *` - 每小时检查一次
- `0 0 * * *` - 每天凌晨检查一次

格式：`分 时 日 月 星期`

## 🎮 使用命令

插件提供以下命令：

### `/mcbe_news [版本]`
获取并展示最新的 MCBE 更新文章（带完整 AI 总结和图片）

**用法：**
- `/mcbe_news` - 获取正式版最新文章（默认）
- `/mcbe_news beta` - 获取 Beta 版最新文章
- `/mcbe_news release` - 获取正式版最新文章

### `/mcbe_list [版本] [数量]`
快速获取最新 n 篇文章的简短预览列表（不含 AI 总结，响应更快）

**用法：**
- `/mcbe_list` - 获取最新 3 篇正式版文章（默认）
- `/mcbe_list 5` - 获取最新 5 篇正式版文章（最多 5 篇）
- `/mcbe_list beta` - 获取最新 3 篇 Beta 版文章
- `/mcbe_list beta 5` - 获取最新 5 篇 Beta 版文章

**特点：**
- 每篇文章显示前 150 字符预览
- 包含标题、时间、链接
- 无需等待 AI 总结，快速浏览

### `/mcbe_register`
**[推荐]** 在当前群聊中注册以接收自动更新通知

这是推荐的设置方式，比手动配置群聊 ID 更可靠。在需要接收通知的群聊中发送此命令即可。

### `/mcbe_unregister`
取消当前群聊的注册，停止接收更新通知

### `/mcbe_check`
手动触发更新检查，如有新文章会推送到配置的群聊

### `/mcbe_status`
查看当前监控状态，包括：
- 配置信息
- 已注册的群聊
- 已记录的文章数量
- 调度器运行状态

### `/mcbe_help`
显示帮助信息

## 🚀 快速开始

1. **安装插件**：在 AstrBot WebUI 的插件市场安装本插件
2. **配置 LLM**：在插件配置页面选择 LLM 提供商
3. **注册群聊**：在需要接收通知的群聊中发送 `/mcbe_register`
4. **测试功能**：发送 `/mcbe_check` 测试是否正常工作
5. **完成**：插件将自动定时检查并推送更新

### 💡 使用建议

- **快速浏览**：使用 `/mcbe_list` 查看最近的多篇更新
- **详细阅读**：使用 `/mcbe_news` 查看完整文章和 AI 总结
- **对比版本**：可以同时查看 Beta 版和正式版的更新情况

## 📝 工作原理

1. **定时检查**：根据配置的 Cron 表达式定时从官方 API 获取文章列表
2. **去重判断**：与本地记录的文章 ID 对比，筛选出新文章
3. **内容解析**：使用 BeautifulSoup 解析文章内容，提取文本和图片
4. **AI 总结**：调用配置的 LLM 模型生成文章摘要
5. **消息推送**：将总结和图片组合成富媒体消息，发送到已注册的群聊

## 📂 数据存储

插件会在 `data/mcbe_news/` 目录下存储数据：

- `seen_articles.json` - 已推送的文章 ID 列表
- `registered_groups.json` - 已注册的群聊信息

## 🔧 技术栈

- **httpx** - 异步 HTTP 请求
- **BeautifulSoup4** - HTML 解析
- **APScheduler** - 定时任务调度
- **Pydantic** - 数据验证

## 📌 注意事项

1. **推荐使用注册方式**：使用 `/mcbe_register` 命令注册群聊比手动配置群聊 ID 更可靠，因为它会自动保存正确的会话标识
2. **网络连接**：插件需要访问 `feedback.minecraft.net`，请确保网络畅通
3. **LLM 配置**：请确保已在 AstrBot 中正确配置至少一个 LLM 提供商
4. **首次运行**：首次启用插件时，会记录当前所有文章为"已见"，不会推送历史文章
5. **权限要求**：机器人需要在目标群聊中有发送消息的权限

## 🐛 问题反馈

如有问题或建议，请提交 Issue 或 PR。

## 📜 许可证

本项目基于 MIT 许可证开源。

---

**开发者**: astrbot_plugin_mcbe_news  
**文档**: [AstrBot 插件开发文档](https://docs.astrbot.app/dev/star/plugin-new.html)
